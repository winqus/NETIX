<!-- eslint-disable @angular-eslint/template/label-has-associated-control -->
<div class="flex justify-center">
  <progress class="progress w-[80%] m-12" [value]="calculateProgress()" max="100"></progress>
</div>

<div class="flex flex-col mb:px-24 xl:px-44 w-full h-[35rem]">
  @if (currentStep === UploadSteps.FileSelection) {
    <div class="flex-[3]">
      <label
        for="dropzone-file"
        class="flex flex-col items-center w-full h-full justify-start p-10 cursor-pointer"
        (dragover)="dragOverHandler($event)"
        (drop)="dropHandler($event, true)"
        (dragleave)="dragLeaveHandler($event)"
      >
        <div class="card bg-slate-950 hover:bg-black p-16 rounded-md m-10" [class.bg-black]="isDraggingOver">
          <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5" />
            <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z" />
          </svg>
        </div>
        @if (mediaFile === null) {
          <p class="mb-2 text-sm"><span class="font-semibold">Click to upload</span> or drag and drop <span class="font-semibold">media file</span></p>
          <p class="text-xs">MP4, MOV, MKV or HEVC</p>
        } @else {
          <p class="text-ellipsis overflow-hidden w-full mb-2 text-sm text-center"><span class="font-semibold">Uploaded</span> {{ this.mediaFile.name }}</p>
        }
        <input id="dropzone-file" type="file" class="hidden" (change)="onFileSelected($event, true)" accept="video/mp4,video/mov,video/x-matroska,video/hevc" />
      </label>
    </div>
    <div class="flex-[1] content-center">
      <div class="flex justify-center justify-self-stretch">
        <button class="btn btn-primary rounded-md" (click)="goToDetailsFilling()">Next</button>
      </div>
    </div>
  } @else if (currentStep === UploadSteps.DetailsFilling) {
    <div class="flex-[3] flex justify-center align-top h-full">
      <div class="flex flex-col w-[40%]">
        <div class="text-left">
          <label class="block text-sm font-medium">Title</label>
          <input type="text" id="media-title" placeholder="Enter media title" class="input input-bordered w-full mb-4 rounded-md" (change)="onChangeTitle($event)" [value]="mediaTitle" />
        </div>
        <div class="text-left">
          <label class="block text-sm font-medium">Release date</label>
          <input type="date" id="media-release-date" class="input input-bordered w-full mb-4 rounded-md" (change)="onChangeDate($event)" [value]="mediaDateToSimpleDateFormat()" />
        </div>
        <div class="text-left">
          <label class="block text-sm font-medium">Media description</label>
          <textarea
            class="textarea textarea-bordered w-full min-h-24 max-h-44 mb-4 rounded-md"
            placeholder="Enter media description"
            (change)="onChangeDescription($event)"
            [value]="mediaDescription"
          ></textarea>
        </div>
      </div>
    </div>
    <div class="flex-[1] content-center">
      <div class="flex justify-center items-end">
        <div class="flex flex-row justify-between w-[40%] gap-10">
          <button class="btn btn-primary rounded-md" (click)="goToFileSelection()">Back</button>
          <button class="btn btn-primary rounded-md" (click)="goToThumnNailSelection()">Next</button>
        </div>
      </div>
    </div>
  } @else if (currentStep === UploadSteps.ThumbNailSelection) {
    <div class="flex-[3]">
      <label
        for="dropzone-file"
        class="flex flex-col items-center w-full h-full justify-start p-10 cursor-pointer"
        (dragover)="dragOverHandler($event)"
        (drop)="dropHandler($event, false, true)"
        (dragleave)="dragLeaveHandler($event)"
      >
        <div class="card bg-slate-950 hover:bg-black p-16 rounded-md m-10" [class.bg-black]="isDraggingOver">
          <svg xmlns="http://www.w3.org/2000/svg" width="50" height="50" fill="currentColor" class="" viewBox="0 0 16 16">
            <path d="M.5 9.9a.5.5 0 0 1 .5.5v2.5a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1v-2.5a.5.5 0 0 1 1 0v2.5a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2v-2.5a.5.5 0 0 1 .5-.5" />
            <path d="M7.646 1.146a.5.5 0 0 1 .708 0l3 3a.5.5 0 0 1-.708.708L8.5 2.707V11.5a.5.5 0 0 1-1 0V2.707L5.354 4.854a.5.5 0 1 1-.708-.708z" />
          </svg>
        </div>
        @if (mediaThumbnail === null) {
          <p class="mb-2 text-sm"><span class="font-semibold">Click to upload</span> or drag and drop <span class="font-semibold">thumbnail file</span></p>
          <p class="text-xs">PNG, JPG or JPEG</p>
        } @else {
          <p class="text-ellipsis overflow-hidden w-full mb-2 text-sm text-center"><span class="font-semibold">Uploaded</span> {{ this.mediaThumbnail.name }}</p>
        }
        <input id="dropzone-file" type="file" class="hidden" (change)="onFileSelected($event, false, true)" accept="image/PNG, image/jpg, image/JPEG" />
      </label>
    </div>
    <div class="flex-[1] content-center">
      <div class="flex justify-center items-end">
        <div class="flex flex-row justify-between w-[40%] gap-10">
          <button class="btn btn-primary rounded-md" (click)="goToDetailsFilling()">Back</button>
          <button class="btn btn-info rounded-md" (click)="goToUploading()">Confirm</button>
        </div>
      </div>
    </div>
  } @else if (currentStep === UploadSteps.Uploading) {}
</div>
